namespace = letter

letter.10 = {
	type = letter_event
	window = "chat_letter_event"

	opening = {
		desc = "letter_desc"
	}

	desc = ""

	sender = scope:actor

	immediate = {
		create_character = {
			age = 0
			name = ""
			dynasty = none
			gender_female_chance = 50
			location = root.capital_province
			faith = root.faith
			culture = root.culture
			save_scope_as = letter_d
		}
		scope:letter_d = {
			death = {
				death_reason = death_vanished
			}
		}
	}

	widgets = {
		widget = {
			gui = "enter_letter_d"
			container = "custom_widgets_container"
			controller = name_character
			setup_scope = { scope:letter_d = { save_scope_as = name_character_target } }
		}
	}

	option = {
		name = "send"

		scope:actor = {
			save_scope_as = letter_author
		}

		scope:letter_recipient = {
			trigger_event = {
				id = letter.20
			}
		}
	}

	option = {
		name = "CANCEL"
	}
}

letter.20 = {
	type = letter_event
	window = "chat_letter_event"

	sender = scope:letter_author

	opening = {
		desc = "Letter from [letter_author.GetNameNoTooltip]"
	}

	desc = "first_letter_text"

	option = {
		name = "send_reply"

		scope:letter_recipient = {
			save_scope_as = actor
		}

		scope:letter_author = {
			save_scope_as = letter_recipient
		}

		trigger_event = {
			id = letter.1
		}

		#remove_variable = pending_letter
	}

	option = {
		name = "close_option"
		#remove_variable = pending_letter
	}
}

letter.1 = {
	type = letter_event
	window = "chat_letter_event"

	opening = {
		desc = "letter_desc"
	}

	desc = ""

	sender = scope:actor

	immediate = {
		create_character = {
			age = 0
			name = "​"
			dynasty = none
			gender_female_chance = 50
			location = root.capital_province
			faith = root.faith
			culture = root.culture
			save_scope_as = letter
		}
		create_character = {
			age = 0
			name = "​"
			dynasty = none
			gender_female_chance = 50
			location = root.capital_province
			faith = root.faith
			culture = root.culture
			save_scope_as = letter_b
		}
		create_character = {
			age = 0
			name = "​"
			dynasty = none
			gender_female_chance = 50
			location = root.capital_province
			faith = root.faith
			culture = root.culture
			save_scope_as = letter_c
		}
		scope:letter = {
			death = {
				death_reason = death_vanished
			}
		}
		scope:letter_b = {
			death = {
				death_reason = death_vanished
			}
		}
		scope:letter_c = {
			death = {
				death_reason = death_vanished
			}
		}
	}

	widgets = {
		widget = {
			gui = "enter_letter"
			container = "custom_widgets_container"
			controller = name_character
			setup_scope = { scope:letter = { save_scope_as = name_character_target } }
		}
		widget = {
			gui = "enter_letter_b"
			container = "custom_widgets_container"
			controller = name_character
			setup_scope = { scope:letter_b = { save_scope_as = name_character_target } }
		}
		widget = {
			gui = "enter_letter_c"
			container = "custom_widgets_container"
			controller = name_character
			setup_scope = { scope:letter_c = { save_scope_as = name_character_target } }
		}
	}

	option = {
		name = "send"

		scope:actor = {
			save_scope_as = letter_author
		}

		scope:letter_recipient = {
			trigger_event = {
				id = letter.2
			}
		}
	}

	option = {
		name = "CANCEL"
	}
}

letter.2 = {
	type = letter_event
	window = "chat_letter_event"

	sender = scope:letter_author

	opening = {
		desc = "Letter from [letter_author.GetNameNoTooltip]"
	}

	desc = "letter_text"

	option = {
		name = "send_reply"

		scope:letter_recipient = {
			save_scope_as = actor
		}

		scope:letter_author = {
			save_scope_as = letter_recipient
		}

		trigger_event = {
			id = letter.1
		}

		#remove_variable = pending_letter
	}

	option = {
		name = "close_option"
		#remove_variable = pending_letter
	}
}
